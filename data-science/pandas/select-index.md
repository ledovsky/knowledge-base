# Pandas Выбор и индексы

Pandas приводит для выбора и разделения таблиц данных очень большое количество методов. В данном разделе собранны наиболее необходимые.

## Доступ к столбцам

```python
df['A']         # Выбрать столбец A
df.A            # Выбрать столбец A
df[u'Б']        # Выбрать столбец Б, для русских колонок
df[['A', 'B']]  # Выбрать несколько столбцов
```

## Выбор строк по условию

[Ссылка на документацию](http://pandas.pydata.org/pandas-docs/stable/indexing.html#boolean-indexing)

Наверное, самый главный способ выбора и разделения данных. Синтакс заключается в указании в квадратных скобках условия. Условие должно быть списком или массивом длинной в количество строк.

```python
df[condition]
```

Простые варианты условий выглядят в виде логических выражений.

```python
df[df.A == 'one']
df[(df.A == 'one') & (df.B > 10)]
df[(df.B > 5) | (df.B > 10)]
```

Более сложные можно сделать с помощью функции map.

```python
criterion = df2['B'].map(lambda x: x.startswith('t'))
df[criterion]
df[criterion & (df.A == 'one')]
```

Для использования в качестве критерия множества дискретных значений можно использовать `.isin`, который применяется к Series.

```python
df[df.A.isin(['one', 'two', 'tree'])]
```

## Выбор строк

Выбрать строки по номерам возможно, указав индексы в квадратных скобках. Необходимо отметить, что, как и в обычном Python, последний индекс не включается.

```python
df[1]     # Первая строка
df[1:3]   # От первой до второй 
df[:3]    # От начала (нулевой строки) до второй
df[5:]    # От 5 до конца
df[::-1]  # Все в обратном порядке
df[::2]   # Каждую вторую строку
```

Для доступа к DataFrame, как к матрице, используется метод `.iloc`. В простых случаях он работает, как обычные квадратные скобки из предыдущего примера. Но также позволяет выбрать элемент по двум индексам

```python
df.iloc[:,1:3]
df.iloc[4,3]
```

Выбор по индексу осуществляется функцией `.loc`. При этом возможно также выбирать промежутки

```python
df.loc['a']
df.loc['a':'f']
df.loc['f':]
df.loc['f']
```

Использование индексов становится актуальным для сводных таблиц.

По умолчанию индекс определяется как arrange(n), где n - количество строк. Индекс может быть назначен одним из столбцов. Также возможен множественный индекс по нескольким столбцам.

```python
df.set_index('A')           # Сделать индексом столбец 'A'
df.set_index(['A', 'B'])    # Сделать индексом столбцы 'A' и 'B'
```

## Выбор случайных строк

Для выбора случайных строк используется функция  `sample`, которая применяется как для DataFrame, так и для Series.

```python
s.sample()          # Выбирает 1 случайную строку
s.sample(n=4)       # Выбирает 4 строки
s.sample(frac=0.2)  # Выбирает 20% строк
```
